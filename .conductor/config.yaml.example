# Conductor Configuration File
#
# Place this file at .conductor/config.yaml in your project root to set default values
# for Conductor CLI commands. CLI flags will override these settings.
#
# Example usage:
#   conductor run plan.md                    # Uses config.yaml defaults
#   conductor run --verbose plan.md          # Verbose flag overrides config
#   conductor run --timeout 2h plan.md       # Timeout flag overrides config

# Maximum number of concurrent tasks
# Set to 0 for unlimited concurrency (default: 0)
max_concurrency: 4

# Task execution timeout
# Supported formats: 30s, 5m, 1h30m, etc.
# Empty means no timeout (default: empty)
timeout: 5m

# Logging level
# Levels: trace, debug, info, warn, error (default: info)
log_level: info

# Log output directory
# Logs will be written to this directory (default: .conductor/logs)
log_dir: .conductor/logs

# Console output configuration
console:
  # Color output control
  # - auto: Auto-detect based on TTY (isatty check) - default
  # - true: Force colors on
  # - false: Force colors off
  # Note: The NO_COLOR environment variable is NOT checked.
  # Color control is exclusively via this config setting.
  colors_enabled: auto

# Dry run mode
# When true, validates and shows what would run without executing (default: false)
dry_run: false

# Skip completed tasks
# When true, skips tasks that are already marked as completed in the plan file (default: false)
skip_completed: false

# Retry failed tasks
# When true, retries tasks that previously failed (default: false)
retry_failed: false

# Quality control configuration
# Controls how tasks are reviewed and retried after execution
quality_control:
  # Enable or disable quality control reviews (default: true)
  enabled: true

  # Agent to use for quality control reviews (default: conductor-qc)
  # This agent reviews task outputs and returns GREEN/RED/YELLOW verdicts
  review_agent: conductor-qc

  # Number of retries on RED verdicts (default: from plan or 2)
  # Plans can override this with conductor.quality_control.retry_on_red
  # If not specified in plan, falls back to config value, then default 2
  retry_on_red: 2

# ===== ADVANCED CONFIGURATION =====
# The settings below are optional and have sensible defaults.
# Uncomment and modify only if you need to change them.

# Example: Run with higher concurrency for parallel tasks
# max_concurrency: 8

# Example: Longer timeout for complex plans
# timeout: 10m

# Example: Debug mode for troubleshooting
# log_level: debug

# Example: Custom log directory
# log_dir: /var/log/conductor

# Example: Enable dry-run by default
# dry_run: true

# Example: Skip tasks that are already completed
# skip_completed: true

# Example: Retry tasks that failed in previous runs
# retry_failed: true

# Learning system configuration
# The learning system tracks task execution history and adapts future executions
learning:
  # Enable or disable the learning system (default: true)
  enabled: true

  # Database path for learning data (default: .conductor/learning/executions.db)
  # This should be a file path, not a directory
  db_path: .conductor/learning/executions.db

  # Auto-adapt agent selection based on learned patterns (default: false)
  # When enabled, conductor will automatically suggest or switch agents based on past successes
  auto_adapt_agent: false

  # Enhance prompts with learned context (default: true)
  # When enabled, conductor enriches task prompts with relevant execution history
  enhance_prompts: true

  # Minimum failures before adapting strategy (default: 2)
  # Conductor will consider adapting after this many consecutive failures
  min_failures_before_adapt: 2

  # Days to keep execution history (default: 90)
  # Older execution records are cleaned up automatically
  keep_executions_days: 90

  # Maximum execution records per task (default: 100)
  # Limits the number of execution records kept for each unique task
  max_executions_per_task: 100

# Example: Disable learning system
# learning:
#   enabled: false

# Example: Custom learning database path (must be a file path, not directory)
# learning:
#   db_path: /var/lib/conductor/learning/executions.db

# Example: Enable automatic agent adaptation
# learning:
#   auto_adapt_agent: true
#   min_failures_before_adapt: 3

# Quality Control Examples

# Example: Enable stricter quality control with more retries
# quality_control:
#   enabled: true
#   retry_on_red: 3

# Example: Use custom QC agent
# quality_control:
#   review_agent: custom-qc-agent
#   retry_on_red: 2

# Note: Plans can override the retry_on_red value in their frontmatter:
# conductor:
#   quality_control:
#     retry_on_red: 3  # This overrides config.yaml setting
