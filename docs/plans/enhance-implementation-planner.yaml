conductor:
  default_agent: python-pro
  max_concurrency: 2

  quality_control:
    enabled: true
    retry_on_red: 2
    agents:
      mode: intelligent
      max_agents: 2

plan:
  metadata:
    feature_name: "Add Implementation Section to Implementation-Planner Skill"
    created: "2025-11-23"
    target: "Generate prescriptive implementation guidance in YAML plans"
    estimated_tasks: 4

  context:
    framework: "Claude Code Skills"
    architecture: "Skill enhancement with reference docs"
    test_framework: "Manual validation"

    project_goal: |
      Update implementation-planner skill to generate structured `implementation:`
      sections in YAML plans, providing agents with prescriptive step-by-step
      guidance instead of high-level descriptions.

    expectations:
      - "Maintain backward compatibility"
      - "Follow existing skill patterns"
      - "Test with example plan generation"

  tasks:
    - task_number: 1
      name: "Update yaml-structure.md Reference"
      type: "component"
      agent: "technical-writer"
      files:
        - "~/.claude/skills/implementation-planner/reference/yaml-structure.md"
      depends_on: []
      estimated_time: "20m"

      success_criteria:
        - "Implementation section documented with full structure"
        - "Examples show approach, code_structure, key_points"
        - "Integration subsection documented"
        - "Matches conductor parser (yaml.go:58-73)"

      test_commands:
        - "cat ~/.claude/skills/implementation-planner/reference/yaml-structure.md | grep -A 30 'implementation:'"

      description: |
        Document the implementation section structure in yaml-structure.md reference.
        Show agents how to generate prescriptive implementation guidance.

      implementation:
        approach: |
          Add new section after task description section showing implementation structure.
          Include code_structure, approach, key_points with nested objects, and integration
          subsection matching conductor's parser.

        key_points:
          - point: "Match conductor parser fields exactly"
            details: "See internal/parser/yaml.go:58-73 for authoritative structure"

          - point: "Show both simple and complex examples"
            details: "Simple: approach + key points. Complex: full structure with integration"

          - point: "Explain when to use each field"
            details: "approach=strategy, code_structure=file structure, key_points=critical steps"

      commit:
        type: "docs"
        message: "add implementation section to yaml-structure reference"

    - task_number: 2
      name: "Create Implementation Template"
      type: "component"
      agent: "technical-writer"
      files:
        - "~/.claude/skills/implementation-planner/templates/implementation-section.yaml"
      depends_on: [1]
      estimated_time: "15m"

      success_criteria:
        - "Template shows complete implementation structure"
        - "Includes approach, code_structure, key_points, integration"
        - "Has inline comments explaining each field"
        - "Shows both minimal and full examples"

      test_commands:
        - "cat ~/.claude/skills/implementation-planner/templates/implementation-section.yaml"

      description: |
        Create reusable template showing implementation section structure
        with examples and inline documentation.

      implementation:
        approach: |
          Create new template file with YAML structure matching parser.
          Include two examples: minimal (approach + key_points) and
          full (all fields including integration).

        code_structure: |
          implementation-section.yaml:
            - minimal_example (approach, key_points)
            - full_example (all fields)
            - field_descriptions (inline comments)

        key_points:
          - point: "Show progressive complexity"
            details: "Start simple, build to full structure"

          - point: "Inline comments for guidance"
            details: "Explain when/why to use each field"

      commit:
        type: "feat"
        message: "add implementation section template"

    - task_number: 3
      name: "Update SKILL.md Instructions"
      type: "component"
      agent: "technical-writer"
      files:
        - "~/.claude/skills/implementation-planner/SKILL.md"
      depends_on: [1, 2]
      estimated_time: "25m"

      success_criteria:
        - "Phase 5 YAML Structure updated with implementation section"
        - "Instructions explain when to generate implementation guidance"
        - "References template and yaml-structure docs"
        - "Validation checklist includes implementation fields"

      test_commands:
        - "grep -A 20 'implementation:' ~/.claude/skills/implementation-planner/SKILL.md"

      description: |
        Update main skill instructions to include implementation section
        generation in Phase 5 and validation in Phase 6.

      implementation:
        approach: |
          Modify Phase 5 YAML Structure section to show implementation block.
          Add guidance on when to include detailed vs minimal implementation.
          Update Phase 6 validation to check implementation completeness.

        key_points:
          - point: "Add to task template in Phase 5"
            details: "Show implementation: {...} after description field"

          - point: "Explain generation criteria"
            details: "Always include approach + key_points minimum. Add code_structure for complex tasks. Add integration for tasks with depends_on"

          - point: "Update validation checklist"
            details: "Check tasks have implementation.approach or implementation.key_points"

        integration:
          imports: []
          services_to_inject: []
          config_values: []
          error_handling:
            - "Reference supporting files exist (templates, reference)"

      commit:
        type: "docs"
        message: "update SKILL.md with implementation section guidance"

    - task_number: 4
      name: "Test with Example Plan Generation"
      type: "integration"
      agent: "fullstack-developer"
      files:
        - "~/.claude/skills/implementation-planner/test-output.yaml"
      depends_on: [1, 2, 3]
      estimated_time: "30m"

      success_criteria:
        - "Skill activated successfully"
        - "Generated plan includes implementation sections"
        - "Implementation sections follow template structure"
        - "YAML parses without errors"

      integration_criteria:
        - "All three updated files work together"
        - "Skill references template correctly"
        - "Validation passes for generated implementation sections"
        - "Generated plan matches conductor parser expectations"

      test_commands:
        - "cat ~/.claude/skills/implementation-planner/test-output.yaml | grep -A 10 'implementation:'"

      description: |
        Test the enhanced skill by generating a sample plan and verifying
        implementation sections are generated correctly.

      implementation:
        approach: |
          Ask implementation-planner skill to create a simple 3-task plan
          for "add user authentication". Verify implementation sections
          are present and well-structured.

        key_points:
          - point: "Use simple test case"
            details: "User auth with 3 tasks: config, module, integration"

          - point: "Verify all three files contribute"
            details: "SKILL.md triggers generation, template guides structure, yaml-structure validates"

          - point: "Manual review of output"
            details: "Check implementation.approach, key_points present and useful"

        integration:
          imports: []
          services_to_inject:
            - "implementation-planner skill"
          config_values: []
          error_handling:
            - "If skill doesn't generate implementation, check SKILL.md Phase 5"
            - "If structure wrong, check template against parser"

      commit:
        type: "test"
        message: "validate implementation section generation"
