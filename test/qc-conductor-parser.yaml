plan:
  name: Conductor Parser Enhancement
  description: |
    Test QC agent selection for Conductor-specific Go code.
    Task adds frontmatter validation to parser - relevant to actual codebase.
  tasks:
    - task_number: "1"
      name: "Add YAML Frontmatter Schema Validation"
      files:
        - internal/parser/frontmatter.go
        - internal/parser/frontmatter_test.go
      depends_on: []
      estimated_time: "10m"
      agent: golang-pro
      description: |
        Add schema validation for YAML frontmatter in plan files.
        Validate required fields: max_concurrency, timeout, skip_completed.
        Return descriptive errors for missing/invalid fields.
      success_criteria:
        - "Validates required frontmatter fields exist"
        - "Returns descriptive validation errors"
        - "Handles missing frontmatter gracefully"
        - "Unit tests cover validation edge cases"
      status: "failed"
      execution_history:
        - attempt_number: "1"
          agent: golang-pro
          verdict: RED
          agent_output: |
            {"type":"result","subtype":"success","is_error":false,"duration_ms":295959,"duration_api_ms":304763,"num_turns":38,"result":"```json\n{\n  \"status\": \"success\",\n  \"summary\": \"Added YAML frontmatter schema validation for runtime config fields with descriptive errors\",\n  \"output\": \"Implemented schema validation for YAML frontmatter fields: max_concurrency (must be >= 0), timeout (valid duration string), skip_completed (bool), retry_failed (bool), dry_run (bool), log_dir (string), log_level (trace/debug/info/warn/error). Added validation functions validateAndAssignRuntimeConfig() for markdown parser and validateYAMLRuntimeConfig() for YAML parser. Both parsers now return descriptive errors like 'invalid max_concurrency: must be >= 0, got -1' or 'invalid timeout: \\\"invalid\\\" is not a valid duration (e.g., \\\"1h\\\", \\\"30m\\\", \\\"2h30m\\\")'. Extended Plan model with optional runtime config fields stored as pointers to distinguish between unset and explicitly set values. Added comprehensive test suites: TestFrontmatterSchemaValidation (12 test cases) for markdown parser and TestYAMLFrontmatterSchemaValidation (8 test cases) for YAML parser covering valid/invalid scenarios. All 465+ existing tests pass with no regressions.\",\n  \"errors\": [],\n  \"files_modified\": [\n    \"internal/models/plan.go\",\n    \"internal/parser/markdown.go\",\n    \"internal/parser/yaml.go\",\n    \"internal/parser/markdown_test.go\",\n    \"internal/parser/yaml_test.go\"\n  ],\n  \"metadata\": {\n    \"new_tests_added\": 20,\n    \"validation_fields\": [\"max_concurrency\", \"timeout\", \"skip_completed\", \"retry_failed\", \"dry_run\", \"log_dir\", \"log_level\"],\n    \"error_types\": [\"negative max_concurrency\", \"invalid duration format\", \"invalid log_level\"],\n    \"all_tests_passed\": true,\n    \"backward_compatible\": true\n  }\n}\n```","session_id":"0247493b-eff2-457a-8c47-ba68696b0a10","total_cost_usd":1.4801167499999996,"usage":{"input_tokens":85,"cache_creation_input_tokens":110738,"cache_read_input_tokens":2477680,"output_tokens":17472,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":110738}},"modelUsage":{"claude-sonnet-4-5-20250929":{"inputTokens":88,"outputTokens":17491,"cacheReadInputTokens":2477680,"cacheCreationInputTokens":119056,"webSearchRequests":0,"costUSD":1.4523929999999998,"contextWindow":200000},"claude-haiku-4-5-20251001":{"inputTokens":14655,"outputTokens":537,"cacheReadInputTokens":0,"cacheCreationInputTokens":8307,"webSearchRequests":0,"costUSD":0.02772375,"contextWindow":200000}},"permission_denials":[],"uuid":"b1925119-7f18-4ad4-b94a-09ba1e3a2fa9"}
          qc_feedback: Multi-agent criteria consensus
          timestamp: "2025-11-17T20:28:13Z"
        - attempt_number: "2"
          agent: golang-pro
          verdict: RED
          agent_output: |
            {"type":"result","subtype":"success","is_error":false,"duration_ms":250990,"duration_api_ms":271328,"num_turns":35,"result":"All tests pass. Now let me provide the JSON output:\n\n```json\n{\n  \"status\": \"success\",\n  \"summary\": \"Added YAML frontmatter schema validation with type checking, unknown field detection, and descriptive error messages\",\n  \"output\": \"Implemented comprehensive schema validation for YAML frontmatter:\\n\\n1. Created internal/sanitize/frontmatter.go with:\\n   - ValidateFrontmatterSchema() validates YAML structure\\n   - Type validation (string, integer, boolean, array, object)\\n   - Unknown field detection with typo suggestions using Levenshtein distance\\n   - Nested validation for conductor, quality_control, and agents sections\\n   - FrontmatterValidationError type with field path and descriptive messages\\n\\n2. Integrated validation into markdown parser (internal/parser/markdown.go:70)\\n   - Schema validation runs before parsing\\n   - Returns descriptive errors for invalid schemas\\n\\n3. Added 25 test cases for schema validation:\\n   - Type mismatches (string for int, number for bool, etc.)\\n   - Unknown fields with similar field suggestions\\n   - Invalid YAML syntax\\n   - Valid configurations pass through\\n\\n4. Fixed existing test that used invalid frontmatter format\\n\\nAll tests passing (400+ tests, 0 failures)\",\n  \"errors\": [],\n  \"files_modified\": [\n    \"internal/sanitize/frontmatter.go\",\n    \"internal/sanitize/frontmatter_test.go\",\n    \"internal/parser/markdown.go\",\n    \"internal/parser/markdown_test.go\",\n    \"internal/cmd/run_test.go\"\n  ],\n  \"metadata\": {\n    \"new_package\": \"internal/sanitize\",\n    \"validation_features\": [\"type_checking\", \"unknown_field_detection\", \"typo_suggestions\", \"nested_validation\"],\n    \"fields_validated\": [\"max_concurrency\", \"timeout\", \"skip_completed\", \"retry_failed\", \"dry_run\", \"log_dir\", \"log_level\", \"default_agent\", \"quality_control\"],\n    \"test_coverage\": \"comprehensive\"\n  }\n}\n```","session_id":"6760bf45-90b6-410c-a841-3831e8f63ef8","total_cost_usd":1.1851814000000003,"usage":{"input_tokens":78,"cache_creation_input_tokens":93263,"cache_read_input_tokens":1846753,"output_tokens":13688,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":93263}},"modelUsage":{"claude-haiku-4-5-20251001":{"inputTokens":26530,"outputTokens":687,"cacheReadInputTokens":0,"cacheCreationInputTokens":8438,"webSearchRequests":0,"costUSD":0.04051250000000001,"contextWindow":200000},"claude-sonnet-4-5-20250929":{"inputTokens":81,"outputTokens":13932,"cacheReadInputTokens":1846753,"cacheCreationInputTokens":101712,"webSearchRequests":0,"costUSD":1.1446688999999999,"contextWindow":200000}},"permission_denials":[],"uuid":"4eb2d798-26b2-44b9-88e2-c2b907a5aa41"}
          qc_feedback: Multi-agent criteria consensus
          timestamp: "2025-11-17T20:32:55Z"
        - attempt_number: "3"
          agent: general-purpose
          verdict: RED
          agent_output: |
            {"type":"result","subtype":"success","is_error":false,"duration_ms":53511,"duration_api_ms":68338,"num_turns":14,"result":"```json\n{\n  \"status\": \"success\",\n  \"summary\": \"YAML frontmatter schema validation already implemented and tested\",\n  \"output\": \"Schema validation exists in internal/sanitize/frontmatter.go with:\\n- ValidateFrontmatterSchema() validates all frontmatter fields\\n- FrontmatterValidationError provides descriptive errors with field paths\\n- Type validation for max_concurrency (integer), timeout (string), skip_completed (boolean)\\n- Unknown field detection with typo suggestions using Levenshtein distance\\n- Nested validation for quality_control and agents sections\\n- Integration: markdown.go:70 calls sanitize.ValidateFrontmatterSchema()\\n- Test coverage: 93.5% with 25+ test cases covering all validation scenarios\\n- All tests pass (TestValidateFrontmatterSchema with 25 subtests)\",\n  \"errors\": [],\n  \"files_modified\": [],\n  \"metadata\": {\n    \"existing_implementation\": \"internal/sanitize/frontmatter.go\",\n    \"test_coverage\": \"93.5%\",\n    \"test_cases\": 25,\n    \"key_features\": [\"type_validation\", \"unknown_field_detection\", \"typo_suggestions\", \"nested_validation\", \"descriptive_errors\"]\n  }\n}\n```","session_id":"6ba42cd2-f353-4103-aaa5-27cde4f9a938","total_cost_usd":0.31257025,"usage":{"input_tokens":201,"cache_creation_input_tokens":36467,"cache_read_input_tokens":437163,"output_tokens":1966,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":36467}},"modelUsage":{"claude-haiku-4-5-20251001":{"inputTokens":5522,"outputTokens":401,"cacheReadInputTokens":8482,"cacheCreationInputTokens":0,"webSearchRequests":0,"costUSD":0.008375199999999998,"contextWindow":200000},"claude-sonnet-4-5-20250929":{"inputTokens":204,"outputTokens":2209,"cacheReadInputTokens":445656,"cacheCreationInputTokens":36467,"webSearchRequests":0,"costUSD":0.30419505,"contextWindow":200000}},"permission_denials":[],"uuid":"8d605f9b-b1d5-4008-97f7-769acb72aa5e"}
          qc_feedback: Multi-agent criteria consensus
          timestamp: "2025-11-17T20:34:37Z"
